# 探究大型语言模型中基于 RAG 的漏洞增强技术

发布时间：2024年08月07日

`RAG` `软件安全` `人工智能`

> Exploring RAG-based Vulnerability Augmentation with LLMs

# 摘要

> 检测软件漏洞对于保障系统安全至关重要。近年来，基于深度学习的漏洞检测模型虽已普及，但受限于训练数据不足。数据增强虽有望缓解此问题，但生成含漏洞代码颇具挑战。为此，我们利用大型语言模型（LLM），探索了变异、注入和扩展三种策略，以增强单语句和多语句漏洞。实验表明，我们的注入式聚类增强RAG方法在f1-score上显著优于现有技术，尤其在大规模数据增强方面，仅需1.88美元即可生成1K样本，展现了其高效与经济性。

> Detecting vulnerabilities is a crucial task for maintaining the integrity, availability, and security of software systems. Utilizing DL-based models for vulnerability detection has become commonplace in recent years. However, such deep learning-based vulnerability detectors (DLVD) suffer from a shortage of sizable datasets to train effectively. Data augmentation can potentially alleviate the shortage of data, but augmenting vulnerable code is challenging and requires designing a generative solution that maintains vulnerability. Hence, the work on generating vulnerable code samples has been limited and previous works have only focused on generating samples that contain single statements or specific types of vulnerabilities. Lately, large language models (LLMs) are being used for solving various code generation and comprehension tasks and have shown inspiring results, especially when fused with retrieval augmented generation (RAG). In this study, we explore three different strategies to augment vulnerabilities both single and multi-statement vulnerabilities, with LLMs, namely Mutation, Injection, and Extension. We conducted an extensive evaluation of our proposed approach on three vulnerability datasets and three DLVD models, using two LLMs. Our results show that our injection-based clustering-enhanced RAG method beats the baseline setting (NoAug), Vulgen, and VGX (two SOTA methods), and Random Oversampling (ROS) by 30.80\%, 27.48\%, 27.93\%, and 15.41\% in f1-score with 5K generated vulnerable samples on average, and 53.84\%, 54.10\%, 69.90\%, and 40.93\% with 15K generated vulnerable samples. Our approach demonstrates its feasibility for large-scale data augmentation by generating 1K samples at as cheap as US$ 1.88.

[Arxiv](https://arxiv.org/abs/2408.04125)