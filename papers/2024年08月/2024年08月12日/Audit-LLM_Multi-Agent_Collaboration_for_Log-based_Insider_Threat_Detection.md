# Audit-LLM：通过多智能体协作，实现基于日志的内部威胁检测。

发布时间：2024年08月12日

`Agent` `网络安全` `人工智能`

> Audit-LLM: Multi-Agent Collaboration for Log-based Insider Threat Detection

# 摘要

> 在内部威胁检测领域，大型语言模型凭借其丰富的常识知识崭露头角。然而，面对日志文件的冗长和活动类型的多样性，LLMs在识别恶意行为时面临挑战。加之，模型产生的结论可能与实际情况脱节，进一步增加了应用难度。为此，我们设计了Audit-LLM框架，通过三个协同工作的代理：Decomposer代理将任务拆解，Tool Builder代理制作工具以应对上下文限制，Executor代理则利用这些工具得出结论。我们还引入了基于证据的多代理辩论机制，通过Executor之间的推理交流，不断优化结论，确保其准确性。实验结果显示，我们的方法在多个数据集上超越了现有技术，显著提升了模型解释的可靠性。

> Log-based insider threat detection (ITD) detects malicious user activities by auditing log entries. Recently, large language models (LLMs) with strong common sense knowledge have emerged in the domain of ITD. Nevertheless, diverse activity types and overlong log files pose a significant challenge for LLMs in directly discerning malicious ones within myriads of normal activities. Furthermore, the faithfulness hallucination issue from LLMs aggravates its application difficulty in ITD, as the generated conclusion may not align with user commands and activity context. In response to these challenges, we introduce Audit-LLM, a multi-agent log-based insider threat detection framework comprising three collaborative agents: (i) the Decomposer agent, breaking down the complex ITD task into manageable sub-tasks using Chain-of-Thought (COT) reasoning;(ii) the Tool Builder agent, creating reusable tools for sub-tasks to overcome context length limitations in LLMs; and (iii) the Executor agent, generating the final detection conclusion by invoking constructed tools. To enhance conclusion accuracy, we propose a pair-wise Evidence-based Multi-agent Debate (EMAD) mechanism, where two independent Executors iteratively refine their conclusions through reasoning exchange to reach a consensus. Comprehensive experiments conducted on three publicly available ITD datasets-CERT r4.2, CERT r5.2, and PicoDomain-demonstrate the superiority of our method over existing baselines and show that the proposed EMAD significantly improves the faithfulness of explanations generated by LLMs.

[Arxiv](https://arxiv.org/abs/2408.08902)