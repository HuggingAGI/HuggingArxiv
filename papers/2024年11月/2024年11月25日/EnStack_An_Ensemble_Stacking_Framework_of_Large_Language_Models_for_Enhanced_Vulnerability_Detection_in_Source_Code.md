# EnStack：一个用于强化源代码漏洞检测的大型语言模型集成堆叠框架

发布时间：2024年11月25日

`LLM应用` `软件安全` `代码检测`

> EnStack: An Ensemble Stacking Framework of Large Language Models for Enhanced Vulnerability Detection in Source Code

# 摘要

> 自动化检测软件漏洞对于提升安全性极为关键，然而现有方法在应对现代代码库的复杂多样时往往力不从心。在本文中，我们推出了 EnStack，这一全新的集成堆叠框架借助自然语言处理（NLP）技术强化了漏洞检测。我们的方法融合了多个用于代码理解的预训练大型语言模型（LLM）：负责语义分析的 CodeBERT、负责结构表示的 GraphCodeBERT 以及具备跨模态能力的 UniXcoder。通过在 Draper VDISC 数据集上对这些模型进行微调，并利用逻辑回归、支持向量机（SVM）、随机森林和 XGBoost 等元分类器整合其输出，EnStack 能够有效捕捉单个模型可能遗漏的复杂代码模式和漏洞。元分类器整合了每个 LLM 的长处，造就了一个在检测各种编程环境中细微且复杂漏洞时表现卓越的综合模型。实验结果显示，EnStack 明显优于现有方法，在准确性、精度、召回率和 F1 分数上均有显著提升。此项工作凸显了集成 LLM 方法在代码分析任务中的潜力，并为运用 NLP 技术推进自动化漏洞检测提供了宝贵的思路。

> Automated detection of software vulnerabilities is critical for enhancing security, yet existing methods often struggle with the complexity and diversity of modern codebases. In this paper, we introduce EnStack, a novel ensemble stacking framework that enhances vulnerability detection using natural language processing (NLP) techniques. Our approach synergizes multiple pre-trained large language models (LLMs) specialized in code understanding CodeBERT for semantic analysis, GraphCodeBERT for structural representation, and UniXcoder for cross-modal capabilities. By fine-tuning these models on the Draper VDISC dataset and integrating their outputs through meta-classifiers such as Logistic Regression, Support Vector Machines (SVM), Random Forest, and XGBoost, EnStack effectively captures intricate code patterns and vulnerabilities that individual models may overlook. The meta-classifiers consolidate the strengths of each LLM, resulting in a comprehensive model that excels in detecting subtle and complex vulnerabilities across diverse programming contexts. Experimental results demonstrate that EnStack significantly outperforms existing methods, achieving notable improvements in accuracy, precision, recall, and F1-score. This work highlights the potential of ensemble LLM approaches in code analysis tasks and offers valuable insights into applying NLP techniques for advancing automated vulnerability detection.

[Arxiv](https://arxiv.org/abs/2411.16561)