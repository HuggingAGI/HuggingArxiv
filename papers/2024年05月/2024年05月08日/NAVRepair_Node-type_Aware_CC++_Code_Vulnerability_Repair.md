# NAVRepair：智能修复C/C++代码漏洞，精准识别节点类型，为您的代码安全护航。

发布时间：2024年05月08日

`LLM应用

这篇论文介绍了一个名为NAVRepair的框架，它专门设计用于C/C++语言的漏洞修复，通过结合抽象语法树（ASTs）中的节点类型信息与错误类型，以及利用大型语言模型（LLMs）的能力来提高漏洞修复的效率和准确性。这种方法体现了LLM在实际应用中的价值，特别是在软件工程领域，因此将其归类为LLM应用。` `软件安全` `漏洞修复`

> NAVRepair: Node-type Aware C/C++ Code Vulnerability Repair

# 摘要

> 深度学习的迅猛发展催生了大型语言模型（LLMs），它们在漏洞修复领域展现出巨大潜力。然而，现有方法在整合代码结构与错误类型方面存在短板，尤其是C/C++语言的复杂性使得漏洞修复任务异常艰巨。为此，我们推出了NAVRepair框架，它巧妙地将抽象语法树（ASTs）中的节点类型信息与错误类型相结合，专为C/C++漏洞修复量身定制。我们的方法通过类型分析精确定位最小编辑节点（MEN），并根据错误类型量身打造上下文信息收集策略。在离线阶段，NAVRepair通过解析代码补丁来识别MEN，并制定规则以提取每种MEN类型的关键上下文信息。在线修复阶段，它深入分析可疑代码，结合常见弱点枚举（CWE）中的漏洞类型模板，生成精准的修复提示。我们在多个LLMs上验证了NAVRepair的卓越性能，证明了它在提升代码漏洞修复效率方面的显著效果。我们的框架不依赖于特定的LLMs，能够迅速适应新出现的漏洞类型。实验结果表明，NAVRepair在帮助LLMs精准定位和修复C/C++漏洞方面表现出色，准确率比现有方法高出26%。我们坚信，NAVRepair的节点类型感知策略将为现实世界C/C++代码的安全性带来革命性的提升。

> The rapid advancement of deep learning has led to the development of Large Language Models (LLMs). In the field of vulnerability repair, previous research has leveraged rule-based fixing, pre-trained models, and LLM's prompt engineering. However, existing approaches have limitations in terms of the integration of code structure with error types. Besides, due to certain features of C/C++ language, vulnerability repair in C/C++ proves to be exceptionally challenging. To address these challenges, we propose NAVRepair, a novel framework that combines the node-type information extracted from Abstract Syntax Trees (ASTs) with error types, specifically targeting C/C++ vulnerabilities. Specifically, our approach employs type analysis to localize the minimum edit node (MEN) and customizes context information collection based on different error types. In the offline stage, NAVRepair parses code patches to locate MENs and designs rules to extract relevant contextual information for each MEN type. In the online repairing stage, it analyzes the suspicious code, combines it with vulnerability type templates derived from the Common Weakness Enumeration (CWE), and generates targeted repair prompts. We evaluate NAVRepair on multiple popular LLMs and demonstrate its effectiveness in improving the performance of code vulnerability repair. Notably, our framework is independent of any specific LLMs and can quickly adapt to new vulnerability types. Extensive experiments validate that NAVRepair achieves excellent results in assisting LLMs to accurately detect and fix C/C++ vulnerabilities. We achieve a 26% higher accuracy compared to an existing LLM-based C/C++ vulnerability repair method. We believe our node type-aware approach has promising application prospects for enhancing real-world C/C++ code security.

[Arxiv](https://arxiv.org/abs/2405.04994)