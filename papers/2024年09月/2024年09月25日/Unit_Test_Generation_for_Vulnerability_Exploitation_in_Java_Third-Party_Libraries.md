# 为Java第三方库中的漏洞利用生成单元测试

发布时间：2024年09月25日

`LLM应用` `软件开发` `网络安全`

> Unit Test Generation for Vulnerability Exploitation in Java Third-Party Libraries

# 摘要

> 开源第三方库在软件开发中广受欢迎，因其能大幅节省时间和资源。然而，这些库中公开的漏洞却带来了重大隐患。现有自动化漏洞检测工具常出现误报，且难以准确追踪漏洞从客户端项目到库代码的传播路径。为此，我们提出了 VULEUT 方法，结合漏洞利用可达性分析与 LLM 驱动的单元测试生成，自动验证第三方库中的漏洞可利用性。VULEUT 首先分析客户端项目，确定漏洞条件是否可达，再利用 LLM 生成单元测试以确认漏洞。我们收集了 32 个第三方库漏洞，并在 70 个真实项目上进行实验，同时与 TRANSFER 和 VESTA 工具对比。结果显示，VULEUT 在 70 个项目中成功确认了 229 个漏洞利用，准确率比基线高出 24%。

> Open-source third-party libraries are widely used in software development. These libraries offer substantial advantages in terms of time and resource savings. However, a significant concern arises due to the publicly disclosed vulnerabilities within these libraries. Existing automated vulnerability detection tools often suffer from false positives and fail to accurately assess the propagation of inputs capable of triggering vulnerabilities from client projects to vulnerable code in libraries. In this paper, we propose a novel approach called VULEUT (Vulnerability Exploit Unit Test Generation), which combines vulnerability exploitation reachability analysis and LLM-based unit test generation. VULEUT is designed to automatically verify the exploitability of vulnerabilities in third-party libraries commonly used in client software projects. VULEUT first analyzes the client projects to determine the reachability of vulnerability conditions. And then, it leverages the Large Language Model (LLM) to generate unit tests for vulnerability confirmation. To evaluate the effectiveness of VULEUT, we collect 32 vulnerabilities from various third-party libraries and conduct experiments on 70 real client projects. Besides, we also compare our approach with two representative tools, i.e., TRANSFER and VESTA. Our results demonstrate the effectiveness of VULEUT, with 229 out of 292 generated unit tests successfully confirming vulnerability exploitation across 70 client projects, which outperforms baselines by 24%.

[Arxiv](https://arxiv.org/abs/2409.16701)