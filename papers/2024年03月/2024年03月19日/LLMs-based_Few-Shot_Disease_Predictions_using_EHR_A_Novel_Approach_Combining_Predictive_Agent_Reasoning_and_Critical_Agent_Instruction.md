# 利用大型语言模型（LLM）和电子健康记录（EHR）进行的少量样本疾病预测：我们提出了一种创新的方法，融合了预测性代理推理与关键性代理指导。

发布时间：2024年03月19日

`Agent` `健康医疗` `人工智能`

> LLMs-based Few-Shot Disease Predictions using EHR: A Novel Approach Combining Predictive Agent Reasoning and Critical Agent Instruction

# 摘要

> 电子健康档案中蕴含的宝贵患者信息，对于疾病预测等健康相关预测任务至关重要。传统上，这些任务依赖于监督学习，这需要大量且难以获得的标记数据集。本研究探讨了使用大型语言模型（LLMs）将患者的结构化访问信息（如诊断、检验结果、处方）转化为自然语言叙述的可能性。我们通过不同的电子健康记录预测策略，评估了LLMs在零样本和少样本情况下的表现。此外，我们还提出了一种创新的方法，该方法涉及具有不同角色的LLM代理：一个负责预测和生成推理过程的预测代理，以及一个分析错误预测并提供改进预测代理推理方法的批评代理。研究结果显示，采用这种方法，LLMs在基于电子健康记录的疾病预测任务上，与传统的监督学习方法相比，能够实现相当不错的少样本性能，这为其在健康领域应用的潜力提供了有力证明。

> Electronic health records (EHRs) contain valuable patient data for health-related prediction tasks, such as disease prediction. Traditional approaches rely on supervised learning methods that require large labeled datasets, which can be expensive and challenging to obtain. In this study, we investigate the feasibility of applying Large Language Models (LLMs) to convert structured patient visit data (e.g., diagnoses, labs, prescriptions) into natural language narratives. We evaluate the zero-shot and few-shot performance of LLMs using various EHR-prediction-oriented prompting strategies. Furthermore, we propose a novel approach that utilizes LLM agents with different roles: a predictor agent that makes predictions and generates reasoning processes and a critic agent that analyzes incorrect predictions and provides guidance for improving the reasoning of the predictor agent. Our results demonstrate that with the proposed approach, LLMs can achieve decent few-shot performance compared to traditional supervised learning methods in EHR-based disease predictions, suggesting its potential for health-oriented applications.

![利用大型语言模型（LLM）和电子健康记录（EHR）进行的少量样本疾病预测：我们提出了一种创新的方法，融合了预测性代理推理与关键性代理指导。](../../../paper_images/2403.15464/x1.png)

![利用大型语言模型（LLM）和电子健康记录（EHR）进行的少量样本疾病预测：我们提出了一种创新的方法，融合了预测性代理推理与关键性代理指导。](../../../paper_images/2403.15464/x2.png)

![利用大型语言模型（LLM）和电子健康记录（EHR）进行的少量样本疾病预测：我们提出了一种创新的方法，融合了预测性代理推理与关键性代理指导。](../../../paper_images/2403.15464/x3.png)

![利用大型语言模型（LLM）和电子健康记录（EHR）进行的少量样本疾病预测：我们提出了一种创新的方法，融合了预测性代理推理与关键性代理指导。](../../../paper_images/2403.15464/x4.png)

[Arxiv](https://arxiv.org/abs/2403.15464)