# LLMs 属于高度受限的生物物理序列优化器

发布时间：2024年10月29日

`LLM应用` `蛋白质工程`

> LLMs are Highly-Constrained Biophysical Sequence Optimizers

# 摘要

> 大型语言模型（LLMs）近来在诸如蛋白质工程和分子设计等各类生物任务中展现出极大的潜力。这些任务通常涉及黑箱离散序列优化，难题在于生成既具备生物学可行性又遵循严格细粒度约束的序列。然而，LLMs 常在这类约束面前捉襟见肘，尤其在生物学领域，验证候选方案既费钱又耗时。在本研究中，我们借助被称作具有边际期望的语言模型优化（LLOME）之法，探究了将 LLMs 用作高约束双层优化器的可能性。此方法融合了离线与在线优化，凭借有限的神谕评估来逐步改进 LLM 生成的序列。我们还提出了全新的训练目标——边际对齐期望（MargE），用于训练 LLM 在奖励和参考分布之间平滑过渡。最后，我们引入了一个与真实生物物理问题有着强烈几何相似性的合成测试套件，能够无需耗时的实验室验证就快速评估 LLM 优化器。我们的发现显示，和遗传算法基线相比，LLMs 在需要更少测试函数评估的情况下达成了显著更低的遗憾解。不过，我们也留意到 LLMs 存在适度的校准偏差，容易出现生成器崩溃，并且在没有明确的真实奖励时难以找出最优解。

> Large language models (LLMs) have recently shown significant potential in various biological tasks such as protein engineering and molecule design. These tasks typically involve black-box discrete sequence optimization, where the challenge lies in generating sequences that are not only biologically feasible but also adhere to hard fine-grained constraints. However, LLMs often struggle with such constraints, especially in biological contexts where verifying candidate solutions is costly and time-consuming. In this study, we explore the possibility of employing LLMs as highly-constrained bilevel optimizers through a methodology we refer to as Language Model Optimization with Margin Expectation (LLOME). This approach combines both offline and online optimization, utilizing limited oracle evaluations to iteratively enhance the sequences generated by the LLM. We additionally propose a novel training objective -- Margin-Aligned Expectation (MargE) -- that trains the LLM to smoothly interpolate between the reward and reference distributions. Lastly, we introduce a synthetic test suite that bears strong geometric similarity to real biophysical problems and enables rapid evaluation of LLM optimizers without time-consuming lab validation. Our findings reveal that, in comparison to genetic algorithm baselines, LLMs achieve significantly lower regret solutions while requiring fewer test function evaluations. However, we also observe that LLMs exhibit moderate miscalibration, are susceptible to generator collapse, and have difficulty finding the optimal solution when no explicit ground truth rewards are available.

[Arxiv](https://arxiv.org/abs/2410.22296)